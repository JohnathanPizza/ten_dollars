; starts a new reading operation
; vr0 buffer
; vr5/1 buffer len

>BRK_READ
	LDA	IO_READ_STATUS
	BNE	_BRK_READ_SKIP
	STZ	IO_READ_IDX		; reset write buffer index
>_BRK_READ_SKIP
	INC	IO_READ_STATUS
	; change state and suspend
	JSR	PROC_LEAVE
	LDA.I	PROC_STATE_IO_READ
	LDY	PROC_ACTIVE_ID
	STA.Y	PROC_STATE
	JMP	SERVICE_CYCLE_BEGIN
